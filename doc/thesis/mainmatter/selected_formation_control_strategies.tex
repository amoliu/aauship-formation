\chapter{Selected Formation Control Strategies}
\label{ch:selformctrl}
\head{This chapter investigates the previously mentioned formation control \todo{ref to seciton here} aspects with focus in three different types of formation control. These three types are analysed with focus on the specific task applied at the Port of Aalborg, afterwards simulated to be able to conclude which of these are the most beneficial to implement at the AAUSHIP fleet.}


\section{Relevant Characteristics}
To have a tool to determine what strategy is the best suited for the
problem described in \vref{sc:mission}, some parameters that describes
different characteristics of a strategy is needed. Listed here is a
description of each key parameter, also mentioning what is desired for
the mission at hand.

\begin{description}
\item[Communication] This should describe what topology form the
	communication has to have, it should also tell what will happen if
	some link breaks. In the topology of the communication can handling
	of task allocation be taken into account when it is of importance
	how the agents will handle the individual tasks.
\item[Control architecture] This should describe what kind of control
	exists, this is also associated with the communication between
	agents. Under each type of strategy different types of control can
	be applied, which can be chosen based on the other parameters in
	this description.
\item[Obstacle avoidance] Is the formation able to avoid obstacles?
	How will it avoid obstacles, no matter if they are known pre mission
	or during mission. How this is done will also be very dependent on
	the formation deviation. If the formation needs to be strictly
	rigid, when obstacle avoidance could be done in other ways while the
	whole formation needs to move together.
\item[Transients of formation] How will the formation act when
	turning?
\item[Scalability] How does the formation strategy scale with addition
	of more agents?
\end{description}
There are also some parameters that is hard to tell by the principle
of the method, which is listed below. These can be used to compare the
strategies after implementation.
\begin{description}
\item[Formation deviation] How strict is the formation, is it rigid,
	can it change formation dynamically if one agent fails?
\item[Preparation time] This is related to the mission setup time. How
	much manual labour is needed to prepare the agents for a mission?
	This could for instance be trajectory generation and how the
	specific pattern needs to be generated.
\item[Time] The mission time for covering the area in a boustrophedon
	pattern.
\item[Energy efficiency] We need a theoretical measure of the
	formation efficiency, but the formation should be the same to be
	comparable.
\item[Wear and tear] Is the controller aggressive? Aggressive
	controllers is known to make more wear and tear on the actuators. So
	if the strategy can be chosen to minimize the wear and tear this
	could be of benefit to the hardware.
\end{description}

\subsection{Energy efficiency}
The energy efficiency of any autonomous systems is relevant because it limits how long the autonomous system can operate autonomously, given that it cannot easily recharge or is fatal for the mission. This means that optimising the energy efficiency is desirable.


For the decision matrix, the options are rated as:

Communication, no comm, limited/local com, no comm

Control arch, rate by complexity judged by the numbers inputs and
outputs together with the control algorithm computing complexity.

Formation deviation, could be defined by us at the path generation

failure


%% Oversigt af control stats

\section{Methods}
\begin{itemize}
\item \textbf{Direct LOS guidance leading to a duckling formation}\\
This strategy takes the rise in a duckling or snake formation. In principle is this a leader that has a follower that has a follower and so on. Thereby will the formation take shape as a snake, when the leader takes off and the followers keep the line of sight to their respective leaders. This can be applied when a formation i.e. needs to manoeuvre through tight spaces between obstacle. This method is not relevant for the application of the AAUSHIP fleet, since these needs to make a spread out formation to cover a larger area when mapping the sea bed.
\item \textbf{Formation via precomputed time parametrised individual paths}
	\begin{itemize}
	\item \textbf{Adaptive formation. Is the time goal reached at each time step for all agents?}\\
	The implementation of this strategy needs to know for each time step for each agent when the goal is. By doing this it is possible to make the agents be in formation at all times because they have individual positions at their respective paths to specific times. If one of the agents does not reach its position in time, the rest of the agents should stop, or slow down, such that the missing agent has the possibility to catch up. This will change the 'time goals' for the rest of the agents, but the agents will keep the formation.
	\item \textbf{No information shared between agents}\\
	If no information is shared between the agents it is assumed that they do not experience any faults. If one of the agents has a fault, that it changes course or slows down, it will make the formation to fail. The individual agents will still follow their respective paths, and therefore reach their end goals, but not at the same time.
	\end{itemize}
\item \textbf{One \ac{FRP} with agents relative to this}\\
This method only makes use of one path for the whole formation. The agents in the setup will be defined with relative positions to a \ac{FRP} at each time step, such that the formation stays rigid and the arms from the \ac{FRP} to the agents are constants. This setup will work as a virtual leader in a rigid formation where only the point on the path (the \ac{FRP}) has information to the agents around it. The individual agents will not be able to communicate, due to the rigid formation.
\item \textbf{Multiple \ac{FRP}s where a formation follows another formation}\\
When more agents are present it could be of benefit to have these in individual subformations. This can be done by defining multiple \ac{FRP}s such that the formations are made relative to these points. Then it is the \ac{FRP}s that needs to be in formation and utilize their informations as formations follow the formation in front. This could be beneficial if a given formation needs to cover a specific area and the rest of the formation needs to continue. This is a tree like leader follower hierachy.
\todo{Det her er en MEGET vag formulering, men jeg er p√• vej ud af doeren.}
\item \textbf{One minima potential field formation}\\
Within the use of potential fields there can be applied on various ways. One way is to determine the formation based on one minima potential field and maxima at the agents. By different designs of these potential fields one can determine how the specific formation should be. One example could be with three agents where their potential maxima are equal both in magnitude and radius. If these three agents are placed near a single potential minima, they would go in direction of the steepest descent, which would be to the centre of the minima. Meanwhile would the agent's local maxima repulse each other which would result in a equally distributed formation around the potential minima, making a triangle formation around the minima.
This design can vary dependent on how the minima are chosen and also how the magnitude of the agent's potential fields are chosen. If multiple agents are added to the setup, and under the same assumptions as before, they would still distribute evenly around the potential minima, but do the more agents they would make a circle formation. \todo{This method cannot contorl the heading of the formation}
\item \textbf{Multiple minima potential field formation}\\
If an more uneven distribution is needed it could be of benefit to implement more local minima. These are not the minima that the formation should follow, but a higher level potential field, only to define the formation. This could be made of several local minima i.e. one for each agent if the triangle formation is performed. If a more complex formation is needed it would be impossible to make from potential fields if only one local minima could be used, as described in the item above. If a line formation is preferable it would need more local minima to make the distribution even.
\item \textbf{Non strict potential field with rain gutter principle}\\
The underlying potential field can be used when designing the path for the formation. This is done from the same principle of potential fields, but instead of the traditional fields that attract and repel evenly around a point, it can be designed as a rain gutter, which runs from the high magnitude to the lowest magnitude. This will make the formation run in the direction of the steepest descent, and therefore the path can be designed using this. If the formation is allowed to diverge from the path, and the requirement is not so strict, one can design the rain gutter more flat, like a 'u' instead of a 'v', where the 'v' would make the formation stay more precise on the determined path.
\item \textbf{Null Space Behaviour}

\end{itemize}

%% Aproaches
\input{mainmatter/potentialfield}

\input{mainmatter/leaderfollower}

\section{Strategy 3: Multi Path following}
Individual paths for the vessels where they follow their respective trajectories with respect to the time. This needs to make a formation for the vessels. They might only need to know from each other how far they are on their respective trajectories, Christoffer Thorvaldsen.

\input{mainmatter/nsbapproach}

\begin{sidewaystable}
\begin{tabular}{l|lllll}
\toprule
\textbf{Approach} & \textbf{Communication} & \textbf{Control architecture} & \textbf{Obstacle avoidance} & \textbf{Transients} & \textbf{Scalability}\\
\hline
Leader follower with LOS&&&&&\\
Leader follower with Potential field&&&&&\\
NSB&&&&&\\
Leader follower with LOS&&&&&\\
Leader follower with LOS&&&&&\\
Leader follower with LOS&&&&&\\
\bottomrule
\end{tabular}
\caption{Decision matrix for the formation strategies}
\label{tab:decision-matrix}
\end{sidewaystable}

